<nav class="navbar navbar-inverse">
    <a class="navbar-brand" href="#"><img src="apple-touch-icon.png" alt="">Stem</a>
    <span class="pull-right">
        <a class="btn glyphicon glyphicon-off" onclick="localStorage.clear();"></a>
        <!-- <a class="btn glyphicon glyphicon-edit" ng-click="edit = true"></a> -->
        <a class="btn glyphicon glyphicon-th-large" onclick="localStorage.userListType = 'grid'; document.querySelector('users[type]').setAttribute('type','grid')"></a>
        <a class="btn glyphicon glyphicon-th-list" onclick="localStorage.userListType = 'list'; document.querySelector('users[type]').setAttribute('type','list')"></a>
    </span>
</nav>

<form class="has-feedback">
    <input
        ng-model               = "userQuery"
        ng-show                = "users"
        typeahead              = "user.Name for user in users | filter: userFilter | orderBy:'Name'"
        typeahead-wait-ms      = "100"
        typeahead-template-url = "user.html"
        typeahead-on-select    = "stemAdd($item); userQuery = undefined"
        placeholder            = "Select User"
        class                  = "form-control"
        type                   = "text"
        tabindex               = "1"
        required/>
    <button type="reset" class="glyphicon glyphicon-remove"></button>
    <script type="text/ng-template" id="user.html">
        <a>
            <name bind-html-unsafe="match.label | typeaheadHighlight:query"></name>
            <role bind-html-unsafe="match.model.Title | typeaheadHighlight:query"></role> -
            <team bind-html-unsafe="match.model.BusinessUnitName | typeaheadHighlight:query"></team>
        </a>
    </script>
</form>
<users
    type                       = "{{userListType}}">
    <user
        ng-repeat              = "user in stems"
        id                     = "{{user.UserID}}"
        status                 = "{{user.KeyscanStatus}}"
        title                  = "{{user.KeyscanStamp}}"
        ui-keydown             = "{ 'backspace delete left up right down': 'userMove($event)' }"
        tabindex               = "1">
            <img
                loadImage
                ng-src         = "{{user.PhotoPath}}"/>
            <info>
                <team>{{user.BusinessUnitName}}</team>
                <name>{{user.Name}}</name>
                <role>{{user.Title}}</role>
            </info>
            <scan>
                <status>{{user.KeyscanStatus}}</status>
                <time>{{user.KeyscanFromNow}}</time>
            </scan>
            <connect>
                <a
                    ng-show    = "user.MobileNumber"
                    href       = "gtalk:chat?jid={{user.Email}}&amp;from_jid={{my.Email}}"
                    class      = "glyphicon glyphicon-send"></a>
                <a
                    ng-show    = "user.MobileNumber"
                    href       = "sms:{{user.MobileNumber}}"
                    class      = "glyphicon glyphicon-comment"></a>
                <a
                    ng-show    = "user.Email"
                    href       = "mailto:{{user.Email}}"
                    class      = "glyphicon glyphicon-envelope"></a>
                <a
                    ng-show    = "user.MobileNumber"
                    href       = "tel:{{user.MobileNumber}}"
                    class      = "glyphicon glyphicon-earphone"></a>
            </connect>
            <x
                ng-click       = "stemRemove(user)"
                class          = "glyphicon glyphicon-remove text-danger"></x>
    </user>
</users>
<tickets
    ng-show = "tickets">
    <h5>Tickets ({{(tickets | filter: {GroupName:'OpenForMe'}).length}})</h5>
    <ticket
        ng-repeat = "ticket in tickets | filter: { GroupName: 'OpenForMe' } | orderBy:'GroupName':true track by ticket.TicketID"
        tabindex  = "1">
        <info>
            <id>{{ticket.TicketID}} Â» {{ticket.AssignedToUser}}</id>
            <title>{{ticket.Title}}</title>
        </info>
        <history></history>
    </ticket>
<!-- <progressbar class = "progress-striped active" value = "userUpdateInterval"></progressbar> -->
</tickets>